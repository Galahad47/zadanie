import * as T3 from "three";


export const cord = [
  [
    -140.7069982071657,
    21.459072286953393
  ],
  [
    -140.06589386393077,
    17.842222705968897
  ],
  [
    -139.4599963718068,
    14.222415535801414
  ],
  [
    -138.88281281774516,
    10.600755307664684
  ],
  [
    -138.32871728682127,
    6.978242795181376
  ],
  [
    -137.79272992149393,
    3.3557861850267616
  ],
  [
    -137.2703377998746,
    -0.26579142622109947
  ],
  [
    -136.75734389243152,
    -3.885746803438533
  ],
  [
    -136.24973338155496,
    -7.5034125421589515
  ],
  [
    -135.7435483527916,
    -11.118193384841375
  ],
  [
    -135.23476255838992,
    -14.729562167876786
  ],
  [
    -134.71914770089745,
    -18.33705474708215
  ],
  [
    -134.19212140964788,
    -21.940263245402615
  ],
  [
    -133.6485645177781,
    -25.53882688430364
  ],
  [
    -133.08259085453528,
    -29.13241947420033
  ],
  [
    -132.48724558003784,
    -32.72073230002963
  ],
  [
    -131.85409640172728,
    -36.303450556851125
  ],
  [
    -131.17266278506747,
    -39.88022050698156
  ],
  [
    -130.4295959655134,
    -43.4506028500648
  ],
  [
    -129.6074667672602,
    -47.014004862248306
  ],
  [
    -128.68291862576316,
    -50.56957857140934
  ],
  [
    -127.62375852001912,
    -54.11606233380923
  ],
  [
    -126.38420085387774,
    -57.651523785434804
  ],
  [
    -124.89675141310467,
    -61.17292210128281
  ],
  [
    -123.05765079794215,
    -64.67531955208345
  ],
  [
    -120.69919705486134,
    -68.15036465752839
  ],
  [
    -117.53340086087047,
    -71.58313514561308
  ],
  [
    -113.02802696284746,
    -74.94491324893016
  ],
  [
    -106.11210821997535,
    -78.17468376340648
  ],
  [
    -94.46224437760054,
    -81.12589807037217
  ],
  [
    -73.37816566887041,
    -83.41021818827684
  ],
  [
    -40.245589313268816,
    -84.17658513709456
  ],
  [
    -9.667655406089759,
    -82.90991327899337
  ],
  [
    8.37159753555838,
    -80.37890507593771
  ],
  [
    18.440970599442313,
    -77.31625282943283
  ],
  [
    24.571509802289587,
    -74.0222577899506
  ],
  [
    28.652750749585223,
    -70.61225167753062
  ],
  [
    31.56905523196037,
    -67.1361528052251
  ],
  [
    33.77010372114239,
    -63.618416900351214
  ],
  [
    35.504258890754,
    -60.07231941804509
  ],
  [
    36.9186303797524,
    -56.50570333894733
  ],
  [
    38.10552172690656,
    -52.9235533402112
  ],
  [
    39.125680239072295,
    -49.329254794221995
  ],
  [
    40.0207245680261,
    -45.725254933525314
  ],
  [
    40.82016994934737,
    -42.11343039270009
  ],
  [
    41.54559401257203,
    -38.49530085145606
  ],
  [
    42.213211008535126,
    -34.872157446059624
  ],
  [
    42.8355210108271,
    -31.24514171438848
  ],
  [
    43.4224011427611,
    -27.615294677091427
  ],
  [
    43.98184936520263,
    -23.983587304721848
  ],
  [
    44.52050606090324,
    -20.35093911176153
  ],
  [
    45.04403042885554,
    -16.718229091028586
  ],
  [
    45.55738056704729,
    -13.086301738835553
  ],
  [
    46.065029272228635,
    -9.455970051436559
  ],
  [
    46.571137299427235,
    -5.828016846348685
  ],
  [
    47.07969949441227,
    -2.2031954413818124
  ],
  [
    47.59467536905284,
    1.4177694657670032
  ],
  [
    48.120113500007214,
    5.034179974436446
  ],
  [
    48.66027813967323,
    8.645361501004901
  ],
  [
    49.21978642140778,
    12.250656892566107
  ],
  [
    49.80376548507984,
    15.849417276212254
  ],
  [
    50.41804087545246,
    19.44098858427114
  ],
  [
    51.069370996956394,
    23.024692363977245
  ],
  [
    51.76574783047997,
    26.5997989549197
  ],
  [
    52.51679252420836,
    30.16549029479281
  ],
  [
    53.33428752058471,
    33.7208083190568
  ],
  [
    54.23290736500885,
    37.264582856571124
  ],
  [
    55.231243020774045,
    40.795329575467036
  ],
  [
    56.35326766934079,
    44.31110298163693
  ],
  [
    57.63048028986251,
    47.809280029096875
  ],
  [
    59.10511331340796,
    51.286233379539695
  ],
  [
    60.83505092622307,
    54.73682353644146
  ],
  [
    62.9015644021827,
    58.15358349515285
  ],
  [
    65.42179008788219,
    61.52536239878966
  ],
  [
    68.56931271773098,
    64.83498166374311
  ],
  [
    72.60853352736562,
    68.05502471075067
  ],
  [
    77.95106990584621,
    71.14001281519968
  ],
  [
    85.23878305033483,
    74.0116523602445
  ],
  [
    95.41431569565516,
    76.53230782448644
  ],
  [
    109.54028901463208,
    78.46829264055532
  ],
  [
    127.73063577212146,
    79.48942079402373
  ],
  [
    147.44563283857468,
    79.32724419846394
  ],
  [
    164.70682757984073,
    78.02707989414655
  ],
  [
    177.73502501597116,
    75.8976813741909
  ],
  [
    -172.93857025878094,
    73.24998594224064
  ],
  [
    -166.2294438573907,
    70.28957889834645
  ],
  [
    -161.27301180899633,
    67.13563778057801
  ],
  [
    -157.49561744339698,
    63.85636851033585
  ],
  [
    -154.5304894741204,
    60.49200457407712
  ],
  [
    -152.14096368738325,
    57.067313268822005
  ],
  [
    -150.17059832124258,
    53.5982289705245
  ],
  [
    -148.51305840576896,
    50.09544651014765
  ],
  [
    -147.09405350811147,
    46.56643682598501
  ],
  [
    -145.8603311310535,
    43.01662026773248
  ],
  [
    -144.77280970135646,
    39.450073773085016
  ],
  [
    -143.80218344359702,
    35.86997048254304
  ],
  [
    -142.92603754008363,
    32.27886032285758
  ],
  [
    -142.12690857221898,
    28.678852984160926
  ],
  [
    -141.39095064659415,
    25.07173923549757
  ],
  [
    -140.7069982071657,
    21.45907228695341
  ]
]




export interface IGlobePoint {
  latitude: number
  longitude: number
}

export const createSkyBox = () => {
  const tLoader = new T3.CubeTextureLoader()
  const texture = tLoader.load([
    './images/skybox/right.png',
    './images/skybox/left.png',
    './images/skybox/top.png',
    './images/skybox/bottom.png',
    './images/skybox/front.png',
    './images/skybox/back.png',
  ])
  return texture
}
//sun
export const createSun = () => {
  const tLoader = new T3.TextureLoader();
  const map = tLoader.load("./images/sun/map.jpg");
  
  const sunSphere = new T3.SphereGeometry(20,32,32)
  const sunMaterial = new T3.MeshPhongMaterial({
    map,
    bumpScale: 0.1,
  });
  const sun = new T3.Mesh(sunSphere,sunMaterial);
  return sun;
};




//earth
export const createEarth = () => {
  const tLoader = new T3.TextureLoader();
  const map = tLoader.load("./images/earth/map.jpg");
  const bumpMap = tLoader.load("./images/earth/bump.jpg");
  const specularMap = tLoader.load("./images/earth/spec.jpg");
  const earthSphere = new T3.SphereGeometry(10, 32, 32);
  const earthMaterial = new T3.MeshPhongMaterial({
    map,
    bumpMap,
    bumpScale: 0.1,
    specularMap,
    specular: new T3.Color("grey"),
  });
  const earth = new T3.Mesh(earthSphere, earthMaterial);
  return earth;
};



export const createTexture = (p0: number, p1: number, COORDS:Array<Array<number>>):T3.Texture =>{
  const canvas = document.createElement('canvas')
  const ctx = canvas.getContext('2d')
  canvas.width = p0
  canvas.height = p1
  ctx!.fillStyle = "red";

  const coordsSort = COORDS.sort((a, b) => a[0] - b[0])
  

  coordsSort.forEach((coords, idx) => {

    const x = ((coords[0] + 180) / 360.0) * p0
    const y = ((coords[1] + 90) / 180.0) * p1
    console.log(x,y)
    ctx!.beginPath()
    if (idx > 0) {
      const xp = ((COORDS[idx - 1][0] + 180) / 360.0) * p0
      const yp = ((COORDS[idx - 1][1] + 90) / 180.0) * p1
      ctx!.moveTo(xp, yp)
      ctx!.lineTo(x, y)
      ctx!.strokeStyle = "red"
      ctx!.lineWidth = 10
      ctx!.stroke()


      ctx!.fillStyle = "rgb(169 ,169 ,169 ,0.4)";
      ctx!.fillRect(x, y, p1-x, p0-y);

    }
  
    
  })

 
  
  
  const textureDed = new T3.Texture(canvas)
  textureDed.needsUpdate = true
  
  var image = canvas.toDataURL("image/png").replace("image/png","image/octet-stream");
  window.location.href = image;

  return textureDed
  

}









export const createEarthClouds = () => {
  const tLoader = new T3.TextureLoader();
  const map = tLoader.load("./images/earth/clouds.jpg");
  const geometry = new T3.SphereGeometry(10, 32, 32);
  const material = new T3.MeshLambertMaterial({
    map,
    opacity: 0.6,
    color: 0xffffff,
    transparent: true,
  });
  const res = new T3.Mesh(geometry, material);
  res.scale.set(1.015, 1.015, 1.015)
  return res;
};

export const createSunWind = () => {
  const SuntLoader = new T3.TextureLoader();
  const map = SuntLoader.load("./images/sun/wind.jpg");
  const sunwindGeometry = new T3.SphereGeometry(10,32,32);
  const sinwindMaterial = new T3.MeshLambertMaterial({
    map,opacity:0.6,color: 0x0000,transparent:true,
  });
  const sunwind = new T3.Mesh(sunwindGeometry,sinwindMaterial);
  sunwind.scale.set(1.015,1.015,1.015)
  return sunwind;
};


// //terminator
// export const calcTerminator = () =>{
//   function calculateSunDeclaration(date: number){
//     var dayOfYear = Math.floor((date-new Date(date.getFullYear(),0,0))/1000/60/60/24);
//     var declination = 23.44 * Math.cos(2*Math.PI/365 * (dayOfYear - 81));
//     return declination;
//   }
//   function calcTerminatorCoord(date: number){
//     var declination = calculateSunDeclaration(date);
//     var TerminatorCoord = [];
//     for (var lng = -180; lng <=180;lng++){
//       var latitude = Math.atan(-Math.cos(lng*Math.PI/180)/Math.tan(declination*Math.PI/180));
//       var latitudedegrees = latitude*180/Math.PI;
//       TerminatorCoord.push([latitudedegrees,lng]);
//     }
//     return calcTerminatorCoord;
//   }
// return calcTerminator
// }
// //









export const drawDefaultMarker = (v: IGlobePoint): T3.Mesh => {
  const geometry = new T3.SphereGeometry(.1, 32, 32)
  const lat = v.latitude * (Math.PI / 180.0)
  const lon = -v.longitude * (Math.PI / 180.0)
  const radius = 10

  const material = new T3.MeshBasicMaterial({
    color: "#33B5E5"
  })

  const mesh = new T3.Mesh(geometry, material)
  mesh.position.set(
    Math.cos(lat) * Math.cos(lon) * radius,
    Math.sin(lat) * radius,
    Math.cos(lat) * Math.sin(lon) * radius
  )
  
 




  mesh.userData
  var xAxis = new T3.Vector3(1,0,0);
  
  return mesh};